name: bnb
channels:
  - pytorch
  - nvidia
  - conda-forge

dependencies:
  # Base
  - conda-forge::python=3.8
  - pytorch::pytorch
  - pytorch::pytorch-cuda=11.8
  - nvidia::cuda=11.8
  # Libraries
  - conda-forge::accelerate
  - conda-forge::einops
  - conda-forge::scipy
  # Development
  - conda-forge::pytest
  - conda-forge::ipython     # better interactive shell
  - conda-forge::ruff        # linting
  - conda-forge::yapf        # code formatting
  - conda-forge::monkeytype  # infer type annotations
  - conda-forge::rich        # better, colored tracebacks, etc

## ENV CREATION - steps to reproduce:
# mamba env remove -n bnb
# mamba create -y -n bnb python=3.8 # creating an empty env bypasses conda
# # and leads to much faster env resolution in the next step https://github.com/mamba-org/mamba/issues/633#issuecomment-812272143
# mamba env update -n bnb -f environment.yml
# mamba activate bnb
#
## PIP:
# pip install --no-cache-dir --no-deps lion_pytorch triton
# cd ~/src; pip install -e bitsandbytes/ transformers/; cd -
#
## ENV UPDATE:
# # add new packages to environment.yml, then:
# mamba env update -n bnb -f environment.yml